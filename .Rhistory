y = "Number of households",
title = "Education level of household head",
subtitle = "FAO/WFP food security survey round 3 2022")
survey %>%
select(survey_id, hoh_education) %>%
mutate(value = 1,
hoh_education = str_replace_all(hoh_education,
"edu_", ""),
hoh_education = fct_relevel(hoh_education,
c("none",
"primary",
"secondary",
"higher"))) %>%
arrange(hoh_education) %>%
filter(!is.na(hoh_education)) %>%
ungroup() %>%
group_by(hoh_education) %>%
summarise(value = sum(value)) %>%
mutate(pc = round(value / sum(value) * 100,
digits = 2)) %>%
ggplot(aes(x = hoh_education, y = pc)) +
geom_col(fill = "grey20") +
geom_text(aes(label = pc),
vjust = -.1,
colour = "white") +
scale_y_continuous(labels = comma) +
labs(x = "Education level of household head",
y = "Number of households",
title = "Education level of household head",
subtitle = "FAO/WFP food security survey round 3 2022")
survey %>%
select(survey_id, hoh_education) %>%
mutate(value = 1,
hoh_education = str_replace_all(hoh_education,
"edu_", ""),
hoh_education = fct_relevel(hoh_education,
c("none",
"primary",
"secondary",
"higher"))) %>%
arrange(hoh_education) %>%
filter(!is.na(hoh_education)) %>%
ungroup() %>%
group_by(hoh_education) %>%
summarise(value = sum(value)) %>%
mutate(pc = round(value / sum(value) * 100,
digits = 2)) %>%
ggplot(aes(x = hoh_education, y = pc)) +
geom_col(fill = "grey20") +
geom_text(aes(label = pc),
vjust = 1,
colour = "white") +
scale_y_continuous(labels = comma) +
labs(x = "Education level of household head",
y = "Number of households",
title = "Education level of household head",
subtitle = "FAO/WFP food security survey round 3 2022")
survey %>%
select(survey_id, hoh_education) %>%
mutate(value = 1,
hoh_education = str_replace_all(hoh_education,
"edu_", ""),
hoh_education = fct_relevel(hoh_education,
c("none",
"primary",
"secondary",
"higher"))) %>%
arrange(hoh_education) %>%
filter(!is.na(hoh_education)) %>%
ungroup() %>%
group_by(hoh_education) %>%
summarise(value = sum(value)) %>%
mutate(pc = round(value / sum(value) * 100,
digits = 2)) %>%
ggplot(aes(x = hoh_education, y = pc)) +
geom_col(fill = "grey20") +
geom_text(aes(label = pc),
vjust = "inward",
colour = "white") +
scale_y_continuous(labels = comma) +
labs(x = "Education level of household head",
y = "Number of households",
title = "Education level of household head",
subtitle = "FAO/WFP food security survey round 3 2022")
survey %>%
select(survey_id, hoh_education) %>%
mutate(value = 1,
hoh_education = str_replace_all(hoh_education,
"edu_", ""),
hoh_education = fct_relevel(hoh_education,
c("none",
"primary",
"secondary",
"higher"))) %>%
arrange(hoh_education) %>%
filter(!is.na(hoh_education)) %>%
ungroup() %>%
group_by(hoh_education) %>%
summarise(value = sum(value)) %>%
mutate(pc = round(value / sum(value) * 100,
digits = 2)) %>%
ggplot(aes(x = hoh_education, y = pc)) +
geom_col(fill = "grey20") +
geom_text(aes(label = pc),
vjust = 1,
colour = "white") +
scale_y_continuous(labels = comma) +
labs(x = "Education level of household head",
y = "Number of households",
title = "Education level of household head",
subtitle = "FAO/WFP food security survey round 3 2022")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)")
survey_mini %>% glimpse()
survey %>% glimpse()
survey %>%
mutate(
edu_higher = ifelse(hoh_education == "edu_higher", 1, 0),
edu_low = ifelse(hoh_education %in% c ("edu_none", "edu_primary"), 1, 0),
edu_primary = ifelse(hoh_education == "edu_primary", 1, 0),
edu_secondary = ifelse(hoh_education == "edu_secondary", 1, 0),
# edu_religious = ifelse(hoh_education ==  "edu_religious", 1, 0),
hh_debt = case_when(hh_debt_borrow_from %in% c(1, 2) ~ 0,
hh_debt_borrow_from %in% c(3, 4, 5, 6, 7, 8, 9) ~ 1,
TRUE ~ 0)) %>%
select(
ims_farmer,
ims_other,
ims_public_em,
ims_stable_ag,
ims_stable_non_ag,
ims_casual_ag,
ims_casual_non_ag,
ims_prof_self_em,
ims_no_income,
shocks_conflict,
shocks_naturalhazard,
shocks_lostwork,
shocks_foodprices,
shocks_cantworkbusiness,
shocks_accesseconomy,
no_accessmarket,
edu_higher,
edu_secondary,
edu_primary,
edu_low,
rural,
children_0_4,
hoh_female,
fies_ateless, fies_fewfoods, fies_healthy, fies_hungry,
fies_worried, fies_ranout, fies_whlday, fies_skipped,
fcs_stap, fcs_pulse, fcs_dairy, fcs_pr,
fcs_veg, fcs_fruit, fcs_fat, fcs_sugar,
fcs_borderline_poor,
cs_stress_hh_assets,
cs_stress_spent_savings,
cs_stress_credit,
cs_stress_borrowed_money,
cs_crisis_sold_prod_assets,
cs_crisis_no_school,
cs_crisis_reduced_health_exp,
cs_crisis_childwork,
cs_crisis_consumed_seed_stocks,
cs_emergency_sold_house,
cs_emergency_hh_risk,
cs_emergency_sold_last_draught,
cs_emergency_hh_migration,
hh_debt_more,
survey_id,
agri_hhd,
hh_size,
no_accessmarket,
not_improved_drinking_water,
tot_income,
income_reduced,
covid_goodstransp,
covid_marketclosed
) %>%
mutate(across(where(is.numeric), ~ replace(., is.na(.), 0))) %>%
write_csv("./data/survey_mini.csv")
survey %>%
mutate(
edu_higher = ifelse(hoh_education == "edu_higher", 1, 0),
edu_low = ifelse(hoh_education %in% c ("edu_none", "edu_primary"), 1, 0),
edu_primary = ifelse(hoh_education == "edu_primary", 1, 0),
edu_secondary = ifelse(hoh_education == "edu_secondary", 1, 0),
# edu_religious = ifelse(hoh_education ==  "edu_religious", 1, 0),
hh_debt = case_when(hh_debt_borrow_from %in% c(1, 2) ~ 0,
hh_debt_borrow_from %in% c(3, 4, 5, 6, 7, 8, 9) ~ 1,
TRUE ~ 0)) %>%
select(
ims_farmer,
ims_other,
ims_public_em,
ims_stable_ag,
ims_stable_non_ag,
ims_casual_ag,
ims_casual_non_ag,
ims_prof_self_em,
ims_no_income,
shocks_conflict,
shocks_naturalhazard,
shocks_lostwork,
shocks_foodprices,
shocks_cantworkbusiness,
shocks_accesseconomy,
no_accessmarket,
edu_higher,
edu_secondary,
edu_primary,
edu_low,
rural,
children_0_4,
hoh_female,
fies_ateless, fies_fewfoods, fies_healthy, fies_hungry,
fies_worried, fies_ranout, fies_whlday, fies_skipped,
fcs_stap, fcs_pulse, fcs_dairy, fcs_pr,
fcs_veg, fcs_fruit, fcs_fat, fcs_sugar,
fcs_borderline_poor,
cs_stress_hh_assets,
cs_stress_spent_savings,
cs_stress_credit,
cs_stress_borrowed_money,
cs_crisis_sold_prod_assets,
cs_crisis_no_school,
cs_crisis_reduced_health_exp,
cs_crisis_childwork,
cs_crisis_consumed_seed_stocks,
cs_emergency_sold_house,
cs_emergency_hh_risk,
cs_emergency_sold_last_draught,
cs_emergency_hh_migration,
hh_debt_more,
survey_id,
agri_hhd,
hh_size,
no_accessmarket,
not_improved_drinking_water,
tot_income,
income_reduced,
covid_goodstransp,
covid_marketclosed
) %>%
mutate(across(where(is.numeric), ~ replace(., is.na(.), 0))) %>%
write_csv("./data/survey_mini.csv")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
filter(p.value <= .05) %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "FAO/WFP food security survey round 3 2022")
mini %>%
select(hhfcs_inv, education_level, physical_security, rural,
natural_hazards, not_improved_floor, not_improved_water,
not_improved_sanitation, not_improved_housing) %>%
# summarise_at(vars(hhfcs_inv:no_electricity), mean)
lm(hhfcs_inv ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
filter(p.value <= .05) %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "Myanmar Multi-sector Needs Assessment, REACH 2022")
mini %>%
select(hhfcs_inv, education_level, physical_security, rural,
natural_hazards, not_improved_floor, not_improved_water,
not_improved_sanitation, not_improved_housing) %>%
# summarise_at(vars(hhfcs_inv:no_electricity), mean)
lm(hhfcs_inv ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "Myanmar Multi-sector Needs Assessment, REACH 2022")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)")
survey_mini <- read_csv("./data/survey_mini.csv")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
filter(p.value <= .05) %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "FAO/WFP food security survey round 3 2022")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)")
mini %>%
select(hhfcs_inv, education_level, physical_security, rural,
natural_hazards, not_improved_floor, not_improved_water,
not_improved_sanitation, not_improved_housing) %>%
# summarise_at(vars(hhfcs_inv:no_electricity), mean)
lm(hhfcs_inv ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)")
mini %>% glimpse()
mini %>%
select(hhfcs_inv, education_level, physical_security, rural,
natural_hazards, not_improved_floor, not_improved_water,
not_improved_sanitation, not_improved_housing,
physical_security) %>%
# summarise_at(vars(hhfcs_inv:no_electricity), mean)
lm(hhfcs_inv ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "Myanmar Multi-sector Needs Assessment, REACH 2022")
survey_mini %>%
left_join(survey %>% select(score = hhfcs_inv, survey_id), by = "survey_id") %>%
select(-survey_id, -matches("cs_|fies_|fcs_"), -tot_income) %>%
lm(score ~ ., data = .) %>%
tidy(conf.int = TRUE) %>%
filter(term != "(Intercept)") %>%
filter(p.value <= .05) %>%
mutate(term = fct_reorder(term, estimate)) %>%
ggplot(aes(x = estimate,
y = term,
colour = estimate)) +
geom_vline(xintercept = 0, lty = 2, colour = "red") +
geom_point() +
geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), height = 0.2) +
scale_colour_viridis(option = "turbo") +
theme(legend.position = "none",
axis.text.y = element_text(size = 7),
axis.title.x = element_text(size = 7, face = "bold")) +
labs(x = "Estimate", y = "",
title = "Coefficient plot, household FCS with selected indicators",
caption = "FAO/WFP food security survey round 3 2022")
mini %>%
group_by(state) %>%
summarise(count = sum(count),
insecure = sum(insecure)) %>%
mutate(pc_insecure = round(insecure / count * 100,
digits = 2)) %>%
ungroup() %>%
mutate(state = fct_reorder(state, pc_insecure)) %>%
ggplot(aes(x = pc_insecure, y = state)) +
geom_col(fill = "grey70") +
geom_text(aes(label = pc_insecure),
size = 2.5,
colour = "black", hjust = 1) +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
labs(x = "Percentage of households", y = "",
title = "Percentage of households who feel insecure, unweighted",
caption = "Myanmar Multi-sector Needs Assessment, REACH 2022")  +
acled %>%
group_by(admin1) %>%
summarise(fatalities = sum(fatalities)) %>%
right_join(pin %>%
group_by(state) %>%
summarise(population = sum(population_2021_proj)),
by = c("admin1" = "state")) %>%
mutate(admin1 = recode(admin1,
"Bago (East)" = "Bago",
"Bago (West)" = "Bago")) %>%
group_by(admin1) %>%
summarise(population = sum(population),
fatalities = sum(fatalities)) %>%
ungroup() %>%
mutate(fatalities_pm = fatalities / population * 1000000,
fatalities_pm = round(fatalities_pm, digits = 0),
admin1 = fct_relevel(admin1, ord)) %>%
arrange(admin1) %>%
ggplot(aes(x = fatalities_pm, y = admin1)) +
geom_col(fill = "grey70") +
geom_text(aes(label = comma(fatalities_pm, accuracy = 4)),
size = 2.5,
colour = "black",
hjust = "inward") +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
scale_x_continuous(labels = comma) +
labs(x = "Conflict fatalities per million",
y = "",
title = "Conflict fatalities per million persons, as of 06-06-2022",
caption = "ACLED; acleddata.com") +
acled %>%
group_by(admin1) %>%
filter(sub_event_type != "Peaceful protest") %>%
summarise(events = n()) %>%
right_join(pin %>%
group_by(state) %>%
summarise(population = sum(population_2021_proj)),
by = c("admin1" = "state")) %>%
mutate(admin1 = recode(admin1,
"Bago (East)" = "Bago",
"Bago (West)" = "Bago")) %>%
group_by(admin1) %>%
summarise(population = sum(population),
events = sum(events)) %>%
ungroup() %>%
mutate(events_pm = events / population * 1000000,
events_pm = round(events_pm, digits = 0),
admin1 = fct_relevel(admin1, ord)) %>%
arrange(admin1) %>%
ggplot(aes(x = events_pm, y = admin1)) +
geom_col(fill = "grey70") +
geom_text(aes(label = comma(events_pm, accuracy = 4)),
size = 2.5,
colour = "black",
hjust = "inward") +
theme(legend.position = "none",
plot.title = element_text(size = 7)) +
scale_x_continuous(labels = comma) +
labs(x = "Conflict events per million",
y = "",
title = "Conflict events per million persons, as of 06-06-2022",
caption = "ACLED; acleddata.com") +
plot_layout(ncol = 2,
heights = c(2, 2))
survey %>%
select(survey_id, hoh_education) %>%
mutate(value = 1,
hoh_education = str_replace_all(hoh_education,
"edu_", ""),
hoh_education = fct_relevel(hoh_education,
c("none",
"primary",
"secondary",
"higher"))) %>%
arrange(hoh_education) %>%
filter(!is.na(hoh_education)) %>%
ungroup() %>%
group_by(hoh_education) %>%
summarise(value = sum(value)) %>%
mutate(pc = round(value / sum(value) * 100,
digits = 2)) %>%
ggplot(aes(x = hoh_education, y = pc)) +
geom_col(fill = "grey20") +
geom_text(aes(label = pc),
vjust = 1,
colour = "white") +
scale_y_continuous(labels = comma) +
labs(x = "Education level of household head",
y = "Number of households",
title = "Education level of household head, FAO/WFP food security survey round 3 2022")
gc()
